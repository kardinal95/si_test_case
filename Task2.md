# Миграция базы данных
**Для выполнения задачи мы выполняем следующие шаги**
- Добавляем таблицу с полями *id*, *name* (далее таблица 2) в базу данных
- Добавляем поле *name_id* в исходную таблицу (далее таблица 1)
- Последовательно обновляем сервисы типа А.
Требуемые изменения - добавление записи имени помимо поля *name* в таблице 1 - в таблицу 2 по внешнему ключу *name_id*
После обновления сервисов мы получим некий набор ранее существующих данных, в которых нет вынесенного в таблицу 2 имени.
- Запускаем скрипт, который должен пройтись по всем записям в таблице 1 и при отсутствии внешнего ключа - проставить его, либо найдя подходящую запись в таблице 2, либо добавив её при необходимости.
После этого шага все записи из таблицы 1 должны быть готовы для работы с новым форматом
- Последовательно обновляем сервисы типа Б.
Требуемые изменения - изменить метод чтения для использования нового формата данных.
После обновления поле *name* в таблице 1 более не читается
- Обновляем сервисы типа А и удаляем запись в поле *name* в таблице 1
- Удаляем поле *name* из таблицы 1